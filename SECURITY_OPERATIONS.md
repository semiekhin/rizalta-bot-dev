# üîê RIZALTA: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–±–ª–µ–º–∞ |
|-----------|--------|----------|
| –ë—ç–∫–∞–ø—ã | ‚úÖ | –¢–æ–ª—å–∫–æ email |
| Firewall | ‚úÖ | OK |
| Fail2ban | ‚úÖ | OK |
| SSH | ‚úÖ | –ø–æ—Ä—Ç 2222, —Ç–æ–ª—å–∫–æ –∫–ª—é—á |
| –°–µ–∫—Ä–µ—Ç—ã | ‚ö†Ô∏è | –¢–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | ‚úÖ | health_check.sh –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω |

---

## üö® –°–†–û–ß–ù–û –ò–°–ü–†–ê–í–ò–¢–¨

### 1. SSH –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
```bash
# –°–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –∏ –æ—Ç–∫–ª—é—á–∏—Ç—å root –ø–æ –ø–∞—Ä–æ–ª—é
sudo nano /etc/ssh/sshd_config

# –ò–∑–º–µ–Ω–∏—Ç—å:
Port 2222
PermitRootLogin prohibit-password
PasswordAuthentication no

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl restart sshd

# –û—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–π –ø–æ—Ä—Ç –≤ firewall
sudo ufw allow 2222/tcp
sudo ufw delete allow OpenSSH
```

**–í–ê–ñ–ù–û:** –ü–µ—Ä–µ–¥ —ç—Ç–∏–º —É–±–µ–¥–∏—Å—å —á—Ç–æ SSH-–∫–ª—é—á –Ω–∞—Å—Ç—Ä–æ–µ–Ω!

### 2. –°–µ–∫—Ä–µ—Ç—ã ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `secrets_backup.txt` –Ω–∞ —Å–≤–æ—ë–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:
```
=== RIZALTA Bot ===
TELEGRAM_BOT_TOKEN=<—Ç–æ–∫–µ–Ω>
OPENAI_API_KEY=<–∫–ª—é—á>
VECTOR_STORE_ID=<id>
ASSISTANT_ID=<id>

=== SMTP ===
rizalta-bot@mail.ru / <–ø–∞—Ä–æ–ª—å>

=== –°–µ—Ä–≤–µ—Ä ===
IP: <ip>
SSH –ø–æ—Ä—Ç: 2222
```

---

## üìã –ï–ñ–ï–î–ù–ï–í–ù–´–ô –ß–ï–ö-–õ–ò–°–¢ (2 –º–∏–Ω)
```
‚ñ° Telegram: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å /start –≤ @RealtMeAI_bot ‚Äî –æ—Ç–≤–µ—Ç–∏–ª?
‚ñ° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å email ‚Äî –ø—Ä–∏—à—ë–ª –±—ç–∫–∞–ø?
```

## üìã –ï–ñ–ï–ù–ï–î–ï–õ–¨–ù–´–ô –ß–ï–ö-–õ–ò–°–¢ (10 –º–∏–Ω)
```
‚ñ° SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è?
‚ñ° systemctl status rizalta-bot ‚Äî active (running)?
‚ñ° systemctl status rizalta-bot-dev ‚Äî active (running)?
‚ñ° df -h ‚Äî –¥–∏—Å–∫ –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω (< 80%)?
‚ñ° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: tail -50 /var/log/backup.log
‚ñ° GitHub: –∫–æ–¥ –∞–∫—Ç—É–∞–ª–µ–Ω?
```

## üìã –ï–ñ–ï–ú–ï–°–Ø–ß–ù–´–ô –ß–ï–ö-–õ–ò–°–¢ (30 –º–∏–Ω)
```
‚ñ° –û–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É: apt update && apt upgrade
‚ñ° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fail2ban: fail2ban-client status sshd
‚ñ° –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤: du -sh /var/log/
‚ñ° –¢–µ—Å—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: —Å–∫–∞—á–∞—Ç—å –±—ç–∫–∞–ø, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
‚ñ° –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pip install -U -r requirements.txt
‚ñ° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSL/–¥–æ–º–µ–Ω—ã –µ—Å–ª–∏ –µ—Å—Ç—å
```

---

## üîÑ –ü–õ–ê–ù –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø (Disaster Recovery)

### –°—Ü–µ–Ω–∞—Ä–∏–π: –°–µ—Ä–≤–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–º–µ—Ä

**–í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: ~30 –º–∏–Ω—É—Ç**

1. **–ù–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä** (5 –º–∏–Ω)
   - –ó–∞–∫–∞–∑–∞—Ç—å VPS (Timeweb/–∞–Ω–∞–ª–æ–≥)
   - Ubuntu 24, –º–∏–Ω–∏–º—É–º 4GB RAM

2. **–ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** (5 –º–∏–Ω)
```bash
   apt update && apt install -y python3-venv python3-pip nodejs npm git ufw fail2ban
   ufw allow 2222/tcp
   ufw allow 80/tcp
   ufw allow 443/tcp
   ufw enable
```

3. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥** (2 –º–∏–Ω)
```bash
   cd /opt
   git clone git@github.com:semiekhin/rizalta-bot.git bot
   cd /opt/bot
```

4. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞** (3 –º–∏–Ω)
   - –°–∫–∞—á–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø –∏–∑ email
   - –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å: `tar -xzf backup.tar.gz -C /opt/bot/`

5. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** (5 –º–∏–Ω)
```bash
   python3 -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt
   npm install
```

6. **Systemd —Å–µ—Ä–≤–∏—Å** (2 –º–∏–Ω)
```bash
   # –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ RESTORE.md
   systemctl daemon-reload
   systemctl enable rizalta-bot
   systemctl start rizalta-bot
```

7. **Webhook** (1 –º–∏–Ω)
```bash
   ./update_webhook.sh
```

8. **–ü—Ä–æ–≤–µ—Ä–∫–∞** (2 –º–∏–Ω)
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å /start –±–æ—Ç—É
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

---

## üóÑÔ∏è –°–¢–†–£–ö–¢–£–†–ê –ë–≠–ö–ê–ü–û–í

### –ß—Ç–æ –±—ç–∫–∞–ø–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:00):
- `.env` ‚Äî —Å–µ–∫—Ä–µ—Ç—ã
- `properties.db` ‚Äî –±–∞–∑–∞ –∫–≤–∞—Ä—Ç–∏—Ä
- `data/` ‚Äî JSON –∫–æ–Ω—Ñ–∏–≥–∏

### –ß—Ç–æ –≤ GitHub (–≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ):
- –í–µ—Å—å –∫–æ–¥
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- RESTORE.md ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:
- –°–µ–∫—Ä–µ—Ç—ã (—Ç–æ–∫–µ–Ω—ã, –ø–∞—Ä–æ–ª–∏)
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø (—Å–∫–∞—á–∏–≤–∞—Ç—å —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ—Å—Ç–æ–π (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

–î–æ–±–∞–≤–∏—Ç—å –≤ cron –ø—Ä–æ–≤–µ—Ä–∫—É –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
```bash
# /opt/bot/health_check.sh
#!/bin/bash
if ! systemctl is-active --quiet rizalta-bot; then
    curl -s "https://api.telegram.org/bot<TOKEN>/sendMessage?chat_id=<YOUR_ID>&text=üö® RIZALTA Bot —É–ø–∞–ª!"
fi
```
```bash
# crontab -e
*/5 * * * * /opt/bot/health_check.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: UptimeRobot (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- uptimerobot.com
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç endpoint –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram/email

### –í–∞—Ä–∏–∞–Ω—Ç 3: Grafana Cloud (freemium)
- –ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –ì—Ä–∞—Ñ–∏–∫–∏, –∞–ª–µ—Ä—Ç—ã
- –î–ª—è —Å–µ—Ä—å—ë–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

---

## üîê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ GITHUB

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—É—à–∏—Ç—å:**
   - `.env`
   - `properties.db`
   - –ü–∞—Ä–æ–ª–∏/—Ç–æ–∫–µ–Ω—ã

2. **–í–∫–ª—é—á–∏—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:**
   - Settings ‚Üí Security ‚Üí Secret scanning
   - Settings ‚Üí Branches ‚Üí Protect main

3. **2FA –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
   - github.com/settings/security

---

## üìÅ –û–†–ì–ê–ù–ò–ó–ê–¶–ò–Ø –ù–ï–°–ö–û–õ–¨–ö–ò–• –ü–†–û–ï–ö–¢–û–í
```
/opt/
‚îú‚îÄ‚îÄ bot/              # RIZALTA prod
‚îú‚îÄ‚îÄ bot-dev/          # RIZALTA dev
‚îú‚îÄ‚îÄ sofia-bot/        # –î—Ä—É–≥–æ–π –ø—Ä–æ–µ–∫—Ç
‚îî‚îÄ‚îÄ project-x/        # –ï—â—ë –ø—Ä–æ–µ–∫—Ç

~/projects-secrets/   # –õ–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —Ç–≤–æ—ë–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
‚îú‚îÄ‚îÄ rizalta.txt
‚îú‚îÄ‚îÄ sofia.txt
‚îî‚îÄ‚îÄ project-x.txt
```

### –®–∞–±–ª–æ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
```
project-name/
‚îú‚îÄ‚îÄ .env.example      # –®–∞–±–ª–æ–Ω –±–µ–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤ (–≤ git)
‚îú‚îÄ‚îÄ .env              # –†–µ–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã (–ù–ï –≤ git)
‚îú‚îÄ‚îÄ RESTORE.md        # –ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
‚îú‚îÄ‚îÄ README.md         # –û–ø–∏—Å–∞–Ω–∏–µ
‚îî‚îÄ‚îÄ ...
```

---

## ‚è∞ –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø

### –°–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:
```bash
#!/bin/bash
# /opt/check_all.sh

echo "=== –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –±–æ—Ç–æ–≤ ==="

for bot in rizalta-bot rizalta-bot-dev; do
    status=$(systemctl is-active $bot)
    if [ "$status" = "active" ]; then
        echo "‚úÖ $bot: —Ä–∞–±–æ—Ç–∞–µ—Ç"
    else
        echo "‚ùå $bot: $status"
    fi
done

echo ""
echo "=== –î–∏—Å–∫ ==="
df -h / | tail -1

echo ""
echo "=== –ü–æ—Å–ª–µ–¥–Ω–∏–µ –±—ç–∫–∞–ø—ã ==="
tail -3 /var/log/backup.log
```

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ü–†–ò –ü–†–û–ë–õ–ï–ú–ê–•

- Timeweb –ø–æ–¥–¥–µ—Ä–∂–∫–∞: support@timeweb.cloud
- GitHub Status: githubstatus.com
- Telegram API Status: core.telegram.org/api/errors

